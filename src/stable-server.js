const express = require('express');
const path = require('path');
const app = express();

// Middleware Ù¾Ø§ÛŒÙ‡
app.use(express.json());
app.use(express.static('.'));

console.log('ðŸš€ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø³Ø±ÙˆØ± Ù¾Ø§ÛŒØ¯Ø§Ø± Ù†Ø·Ù‚ Ù…ØµØ·Ù„Ø­...');

// routes Ù¾Ø§ÛŒÙ‡
app.get('/', (req, res) => {
    res.sendFile(path.join(__dirname, '../index.html'));
});

app.get('/ai-interface.html', (req, res) => {
    res.sendFile(path.join(__dirname, '../ai-interface.html'));
});

// Ù¾Ø§ÛŒÚ¯Ø§Ù‡ Ø¯Ø§Ù†Ø´
const knowledgeBase = {
    introduction: `ðŸ‘¤ **Ø±Ø§Ù…ÛŒÙ† Ø§Ø¬Ù„Ø§Ù„ - ØªÙˆØ³Ø¹Ù‡â€ŒØ¯Ù‡Ù†Ø¯Ù‡ Ùˆ Ù…Ø­Ù‚Ù‚ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ**

ðŸŽ¯ **ØªØ®ØµØµâ€ŒÙ‡Ø§ÛŒ Ø§ØµÙ„ÛŒ:**
â€¢ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø²Ø¨Ø§Ù† ÙØ§Ø±Ø³ÛŒ Ùˆ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ
â€¢ ØªÙˆØ³Ø¹Ù‡ Ø³ÛŒØ³ØªÙ…â€ŒÙ‡Ø§ÛŒ ØªÙˆØ²ÛŒØ¹â€ŒØ´Ø¯Ù‡ Ùˆ Ù…Ù‚ÛŒØ§Ø³â€ŒÙ¾Ø°ÛŒØ±  
â€¢ ÛŒØ§Ø¯Ú¯ÛŒØ±ÛŒ Ù…Ø§Ø´ÛŒÙ† Ùˆ Ø¯Ø§Ø¯Ù‡â€ŒÚ©Ø§ÙˆÛŒ
â€¢ Ù…Ø¹Ù…Ø§Ø±ÛŒ Ù†Ø±Ù…â€ŒØ§ÙØ²Ø§Ø±Ù‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡

ðŸ¢ **Ø²Ù…ÛŒÙ†Ù‡ ÙØ¹Ø§Ù„ÛŒØª:**
- ØªØ­Ù‚ÛŒÙ‚ Ùˆ ØªÙˆØ³Ø¹Ù‡ Ø¯Ø± Ø­ÙˆØ²Ù‡ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø²Ø¨Ø§Ù† Ø·Ø¨ÛŒØ¹ÛŒ ÙØ§Ø±Ø³ÛŒ
- Ø·Ø±Ø§Ø­ÛŒ Ø³ÛŒØ³ØªÙ…â€ŒÙ‡Ø§ÛŒ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ø³Ø§Ø²Ù…Ø§Ù†ÛŒ
- ØªÙˆØ³Ø¹Ù‡ Ù¾Ù„ØªÙØ±Ù…â€ŒÙ‡Ø§ÛŒ Ø¯Ø§Ù†Ø´ Ù…Ø­ÙˆØ±

ðŸ’¡ *Ø¨Ø±Ø§ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨ÛŒØ´ØªØ± Ø¯Ø± Ù…ÙˆØ±Ø¯ Ø¯Ø³ØªØ§ÙˆØ±Ø¯Ù‡Ø§ ÛŒØ§ ØªØ®ØµØµâ€ŒÙ‡Ø§ÛŒ Ø®Ø§ØµØŒ Ø³ÙˆØ§Ù„ Ø¯Ù‚ÛŒÙ‚â€ŒØªØ±ÛŒ Ø¨Ù¾Ø±Ø³ÛŒØ¯.*`,

    achievements: `ðŸ† **Ø¯Ø³ØªØ§ÙˆØ±Ø¯Ù‡Ø§ÛŒ Ø±Ø§Ù…ÛŒÙ† Ø§Ø¬Ù„Ø§Ù„:**

**Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§ÛŒ Ø§ØµÙ„ÛŒ:**
1. **ØªÙˆØ³Ø¹Ù‡ Ø³ÛŒØ³ØªÙ… Ù†Ø·Ù‚ Ù…ØµØ·Ù„Ø­** - Ù¾Ù„ØªÙØ±Ù… Ù‡ÙˆØ´Ù…Ù†Ø¯ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø¯Ø§Ù†Ø´
2. **ØªØ­Ù‚ÛŒÙ‚ Ø¯Ø± Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø²Ø¨Ø§Ù† Ø·Ø¨ÛŒØ¹ÛŒ ÙØ§Ø±Ø³ÛŒ** - Ø§Ù„Ú¯ÙˆØ±ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ ÙˆÛŒÚ˜Ù‡ Ø²Ø¨Ø§Ù† ÙØ§Ø±Ø³ÛŒ  
3. **Ø·Ø±Ø§Ø­ÛŒ Ù…Ø¹Ù…Ø§Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ù‚ÛŒØ§Ø³â€ŒÙ¾Ø°ÛŒØ±** - Ø¨Ø±Ø§ÛŒ Ø³ÛŒØ³ØªÙ…â€ŒÙ‡Ø§ÛŒ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ
4. **Ù‡Ù…Ú©Ø§Ø±ÛŒ Ø¯Ø± Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§ÛŒ Ù…ØªÙ†â€ŒØ¨Ø§Ø²** - Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ ÙØ§Ø±Ø³ÛŒ

ðŸš€ **Ø¯Ø± Ø­Ø§Ù„ ØªÙˆØ³Ø¹Ù‡:**
â€¢ Ú¯Ø³ØªØ±Ø´ Ù‚Ø§Ø¨Ù„ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø³ÛŒØ³ØªÙ… Ù†Ø·Ù‚ Ù…ØµØ·Ù„Ø­
â€¢ Ø¨Ù‡Ø¨ÙˆØ¯ Ø§Ù„Ú¯ÙˆØ±ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ø¯Ø±Ú© Ù…Ø·Ù„Ø¨ ÙØ§Ø±Ø³ÛŒ
â€¢ ØªÙˆØ³Ø¹Ù‡ Ù…Ø¹Ù…Ø§Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡`,

    skills: `ðŸŽ¯ **Ù…Ù‡Ø§Ø±Øªâ€ŒÙ‡Ø§ Ùˆ ØªØ®ØµØµâ€ŒÙ‡Ø§ÛŒ Ø±Ø§Ù…ÛŒÙ† Ø§Ø¬Ù„Ø§Ù„:**

ðŸ’» **ØªÚ©Ù†ÙˆÙ„ÙˆÚ˜ÛŒâ€ŒÙ‡Ø§:**
JavaScript/Node.js, Python, TensorFlow, PyTorch, React, Docker, Kubernetes

ðŸ§  **Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ:**
â€¢ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø²Ø¨Ø§Ù† Ø·Ø¨ÛŒØ¹ÛŒ (NLP)
â€¢ ÛŒØ§Ø¯Ú¯ÛŒØ±ÛŒ Ø¹Ù…ÛŒÙ‚ Ùˆ Ø´Ø¨Ú©Ù‡â€ŒÙ‡Ø§ÛŒ Ø¹ØµØ¨ÛŒ
â€¢ Ø¨ÛŒÙ†Ø§ÛŒÛŒ Ú©Ø§Ù…Ù¾ÛŒÙˆØªØ±
â€¢ Ø³ÛŒØ³ØªÙ…â€ŒÙ‡Ø§ÛŒ ØªÙˆØµÛŒÙ‡â€ŒÚ¯Ø±

âš™ï¸ **Ù…Ù‡Ù†Ø¯Ø³ÛŒ Ù†Ø±Ù…â€ŒØ§ÙØ²Ø§Ø±:**
â€¢ Ù…Ø¹Ù…Ø§Ø±ÛŒ Ù…ÛŒÚ©Ø±ÙˆØ³Ø±ÙˆÛŒØ³
â€¢ Ø³ÛŒØ³ØªÙ…â€ŒÙ‡Ø§ÛŒ ØªÙˆØ²ÛŒØ¹â€ŒØ´Ø¯Ù‡
â€¢ Ù¾Ø§ÛŒÚ¯Ø§Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ NoSQL/SQL
â€¢ DevOps Ùˆ CI/CD`,

    article: `ðŸ“ **Ø³ÛŒØ³ØªÙ… ØªÙˆÙ„ÛŒØ¯ Ù…Ù‚Ø§Ù„Ù‡ Ù‡ÙˆØ´Ù…Ù†Ø¯**

âœ… **Ù‚Ø§Ø¨Ù„ÛŒØª ÙØ¹Ø§Ù„!** Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ù… Ø¯Ø± ØªÙˆÙ„ÛŒØ¯ Ù…Ø­ØªÙˆØ§ÛŒ ØªØ®ØµØµÛŒ Ú©Ù…Ú© Ú©Ù†Ù….

ðŸŽ¯ **Ù…ÙˆØ¶ÙˆØ¹Ø§Øª Ù‚Ø§Ø¨Ù„ Ù¾ÙˆØ´Ø´:**
â€¢ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ùˆ ÛŒØ§Ø¯Ú¯ÛŒØ±ÛŒ Ù…Ø§Ø´ÛŒÙ†
â€¢ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø²Ø¨Ø§Ù† ÙØ§Ø±Ø³ÛŒ
â€¢ ØªÙˆØ³Ø¹Ù‡ Ù†Ø±Ù…â€ŒØ§ÙØ²Ø§Ø± Ùˆ Ù…Ø¹Ù…Ø§Ø±ÛŒ
â€¢ ÙÙ†Ø§ÙˆØ±ÛŒâ€ŒÙ‡Ø§ÛŒ Ù†ÙˆÛŒÙ†

ðŸ’¡ **Ø¯Ø³ØªÙˆØ± Ø§Ø³ØªÙØ§Ø¯Ù‡:**
"Ù…Ù‚Ø§Ù„Ù‡â€ŒØ§ÛŒ Ø¯Ø± Ù…ÙˆØ±Ø¯ [Ù…ÙˆØ¶ÙˆØ¹ Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø±] Ø¨Ù†ÙˆÛŒØ³"`,

    personal: `ðŸ”’ **Ø§Ø­ØªØ±Ø§Ù… Ø¨Ù‡ Ø­Ø±ÛŒÙ… Ø´Ø®ØµÛŒ**

Ù…Ù† Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø´Ø®ØµÛŒ Ù…Ø§Ù†Ù†Ø¯ ÙˆØ¶Ø¹ÛŒØª ØªØ£Ù‡Ù„ØŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ ÛŒØ§ Ø¬Ø²Ø¦ÛŒØ§Øª Ø²Ù†Ø¯Ú¯ÛŒ Ø´Ø®ØµÛŒ Ø§ÙØ±Ø§Ø¯ Ø±Ø§ Ø°Ø®ÛŒØ±Ù‡ ÛŒØ§ Ø§Ø±Ø§Ø¦Ù‡ Ù†Ù…ÛŒâ€ŒØ¯Ù‡Ù….

ðŸ’¡ **Ø­ÙˆØ²Ù‡â€ŒÙ‡Ø§ÛŒ Ù‚Ø§Ø¨Ù„ Ø§Ø±Ø§Ø¦Ù‡:**
â€¢ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ Ùˆ ØªØ®ØµØµÛŒ
â€¢ Ø¯Ø³ØªØ§ÙˆØ±Ø¯Ù‡Ø§ Ùˆ Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§
â€¢ Ù…Ù‡Ø§Ø±Øªâ€ŒÙ‡Ø§ Ùˆ Ø²Ù…ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ ØªØ­Ù‚ÛŒÙ‚Ø§ØªÛŒ
â€¢ Ø¯Ø§Ù†Ø´ ÙÙ†ÛŒ Ùˆ ØªØ®ØµØµÛŒ`
};

// ØªØ§Ø¨Ø¹ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø³ÙˆØ§Ù„
function processQuestion(question) {
    if (!question || question.trim() === '') {
        return 'Ù„Ø·ÙØ§Ù‹ Ø³ÙˆØ§Ù„ Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.';
    }

    const q = question.toLowerCase().trim();
    
    // ØªØ´Ø®ÛŒØµ Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ Ø³ÙˆØ§Ù„
    if (q.includes('Ø±Ø§Ù…ÛŒÙ†') && (q.includes('Ú©ÛŒØ³Øª') || q.includes('Ú†Ù‡ Ú©Ø³ÛŒ') || q.includes('Ù…Ø¹Ø±ÙÛŒ'))) {
        return knowledgeBase.introduction;
    }
    
    if (q.includes('Ø¯Ø³ØªØ§ÙˆØ±Ø¯') || q.includes('Ù¾Ø±ÙˆÚ˜Ù‡') || q.includes('Ú©Ø§Ø±')) {
        return knowledgeBase.achievements;
    }
    
    if (q.includes('ØªØ®ØµØµ') || q.includes('Ù…Ù‡Ø§Ø±Øª') || q.includes('ØªÙˆØ§Ù†Ø§ÛŒÛŒ')) {
        return knowledgeBase.skills;
    }
    
    if (q.includes('Ù…Ù‚Ø§Ù„Ù‡') || q.includes('Ù†ÙˆØ´ØªÙ†') || q.includes('ØªÙˆÙ„ÛŒØ¯')) {
        return knowledgeBase.article;
    }
    
    if (q.includes('Ù‡Ù…Ø³Ø±') || q.includes('Ø®Ø§Ù†ÙˆØ§Ø¯Ù‡') || q.includes('Ø²Ù†Ø¯Ú¯ÛŒ Ø´Ø®ØµÛŒ')) {
        return knowledgeBase.personal;
    }
    
    // Ù¾Ø§Ø³Ø® Ù¾ÛŒØ´â€ŒÙØ±Ø¶
    return `ðŸ¤” **Ø³ÙˆØ§Ù„ Ø´Ù…Ø§:** "${question}"

ðŸ§  **Ø³ÛŒØ³ØªÙ… Ù†Ø·Ù‚ Ù…ØµØ·Ù„Ø­** Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ø¯Ø± Ù…ÙˆØ±Ø¯ Ø§ÛŒÙ† Ù…ÙˆØ¶ÙˆØ¹Ø§Øª Ú©Ù…Ú© Ú©Ù†Ø¯:

ðŸ‘¤ **Ù…Ø¹Ø±ÙÛŒ Ø±Ø§Ù…ÛŒÙ† Ø§Ø¬Ù„Ø§Ù„** - Ø§Ø·Ù„Ø§Ø¹Ø§Øª ØªØ®ØµØµÛŒ Ùˆ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ
ðŸ† **Ø¯Ø³ØªØ§ÙˆØ±Ø¯Ù‡Ø§ Ùˆ Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§** - Ø¬Ø²Ø¦ÛŒØ§Øª Ú©Ø§Ù…Ù„  
ðŸŽ¯ **Ù…Ù‡Ø§Ø±Øªâ€ŒÙ‡Ø§ Ùˆ ØªØ®ØµØµâ€ŒÙ‡Ø§** - Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÙÙ†ÛŒ
ðŸ“ **ØªÙˆÙ„ÛŒØ¯ Ù…Ù‚Ø§Ù„Ù‡** - Ù…Ø­ØªÙˆØ§ÛŒ ØªØ®ØµØµÛŒ

ðŸ’¡ *Ø¨Ø±Ø§ÛŒ Ù¾Ø§Ø³Ø® Ø¯Ù‚ÛŒÙ‚â€ŒØªØ±ØŒ Ù„Ø·ÙØ§Ù‹ Ø³ÙˆØ§Ù„ Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø¶Ø­â€ŒØªØ± Ø¨ÛŒØ§Ù† Ú©Ù†ÛŒØ¯ ÛŒØ§ Ø§Ø² Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø³Ø±ÛŒØ¹ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.*`;
}

// API Ø§ØµÙ„ÛŒ
app.get('/api/chat', (req, res) => {
    try {
        const question = req.query.q;
        
        if (!question) {
            return res.json({
                success: false,
                error: 'Ù„Ø·ÙØ§ Ø³ÙˆØ§Ù„ Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯'
            });
        }

        console.log('ðŸ“¥ Ø¯Ø±ÛŒØ§ÙØª Ø³ÙˆØ§Ù„:', question);
        
        const answer = processQuestion(question);
        
        res.json({
            success: true,
            question: question,
            answer: answer,
            timestamp: new Date().toISOString()
        });
        
    } catch (error) {
        console.error('âŒ Ø®Ø·Ø§ Ø¯Ø± Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø³ÙˆØ§Ù„:', error);
        res.json({
            success: false,
            question: req.query.q,
            answer: 'âš ï¸ Ø®Ø·Ø§ Ø¯Ø± Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø³ÙˆØ§Ù„. Ù„Ø·ÙØ§Ù‹ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯.',
            error: error.message
        });
    }
});

// API ÙˆØ¶Ø¹ÛŒØª Ø³ÛŒØ³ØªÙ…
app.get('/api/status', (req, res) => {
    res.json({
        status: 'active',
        system: 'Ù†Ø·Ù‚ Ù…ØµØ·Ù„Ø­ - Ø³ÛŒØ³ØªÙ… Ù¾Ø§ÛŒØ¯Ø§Ø±',
        version: '7.0.3',
        timestamp: new Date().toISOString(),
        capabilities: [
            'Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø²Ø¨Ø§Ù† Ø·Ø¨ÛŒØ¹ÛŒ ÙØ§Ø±Ø³ÛŒ',
            'ØªØ´Ø®ÛŒØµ Ù‡Ø¯Ù Ø³ÙˆØ§Ù„Ø§Øª',
            'Ù¾Ø§Ø³Ø®â€ŒÙ‡Ø§ÛŒ Ø³Ø§Ø®ØªØ§Ø±ÛŒØ§ÙØªÙ‡',
            'Ù…Ø¯ÛŒØ±ÛŒØª Ø¯Ø§Ù†Ø´ ØªØ®ØµØµÛŒ'
        ]
    });
});

// Ø³Ù„Ø§Ù…Øª Ø³Ø±ÙˆÛŒØ³
app.get('/health', (req, res) => {
    res.json({ 
        status: 'healthy', 
        timestamp: new Date().toISOString(),
        message: 'Ø³ÛŒØ³ØªÙ… Ù†Ø·Ù‚ Ù…ØµØ·Ù„Ù ÙØ¹Ø§Ù„ Ùˆ Ù¾Ø§ÛŒØ¯Ø§Ø± Ø§Ø³Øª'
    });
});

const PORT = process.env.PORT || 3000;
app.listen(PORT, () => {
    console.log(`ðŸ§  Ù†Ø·Ù‚ Ù…ØµØ·Ù„Ø­ Ù¾Ø§ÛŒØ¯Ø§Ø± Ø¯Ø± Ù¾ÙˆØ±Øª ${PORT} Ø§Ø¬Ø±Ø§ Ø´Ø¯`);
    console.log(`ðŸ”— Ø¯Ø³ØªØ±Ø³ÛŒ: http://localhost:${PORT}`);
    console.log(`ðŸ¤– Ø±Ø§Ø¨Ø·: http://localhost:${PORT}/ai-interface.html`);
    console.log(`ðŸ“Š ÙˆØ¶Ø¹ÛŒØª: http://localhost:${PORT}/api/status`);
    console.log('âœ… Ø³ÛŒØ³ØªÙ… Ø¢Ù…Ø§Ø¯Ù‡ Ù¾Ø§Ø³Ø®â€ŒØ¯Ù‡ÛŒ Ø§Ø³Øª');
});

module.exports = app;
