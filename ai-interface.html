<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø·Ù‚ Ù…ØµØ·Ù„Ø­ - Ø³ÛŒØ³ØªÙ… Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; background: rgba(255, 255, 255, 0.95); border-radius: 20px; box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1); overflow: hidden; }
        .header { background: linear-gradient(135deg, #2c3e50, #34495e); color: white; padding: 30px; text-align: center; }
        .header h1 { font-size: 2.5rem; margin-bottom: 10px; }
        .status-badge { display: inline-block; background: #27ae60; color: white; padding: 8px 16px; border-radius: 20px; margin: 10px 0; }
        .main-content { display: grid; grid-template-columns: 1fr 350px; gap: 0; min-height: 600px; }
        .chat-container { padding: 30px; border-left: 1px solid #eee; }
        .chat-messages { height: 400px; overflow-y: auto; padding: 20px; background: #f8f9fa; border-radius: 15px; margin-bottom: 20px; border: 1px solid #e9ecef; }
        .message { margin-bottom: 20px; padding: 15px; border-radius: 15px; max-width: 80%; line-height: 1.6; }
        .user-message { background: linear-gradient(135deg, #667eea, #764ba2); color: white; margin-right: auto; margin-left: 20%; }
        .ai-message { background: white; border: 2px solid #e9ecef; margin-left: auto; margin-right: 20%; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08); }
        .input-container { display: flex; gap: 10px; margin-top: 20px; }
        .input-container input { flex: 1; padding: 15px 20px; border: 2px solid #e9ecef; border-radius: 12px; font-size: 1rem; outline: none; }
        .input-container input:focus { border-color: #667eea; box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1); }
        .input-container button { padding: 15px 25px; background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; border-radius: 12px; cursor: pointer; font-size: 1rem; font-weight: 600; transition: all 0.3s ease; }
        .input-container button:hover { transform: translateY(-2px); box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3); }
        .quick-actions { background: #f8f9fa; padding: 30px; border-right: 1px solid #e9ecef; }
        .action-buttons { display: flex; flex-direction: column; gap: 12px; }
        .action-btn { padding: 15px 20px; background: white; border: 2px solid #e9ecef; border-radius: 12px; cursor: pointer; text-align: right; font-size: 1rem; transition: all 0.3s ease; display: flex; align-items: center; gap: 10px; }
        .action-btn:hover { border-color: #667eea; transform: translateX(-5px); }
        .system-info { background: linear-gradient(135deg, #34495e, #2c3e50); color: white; padding: 30px; text-align: center; }
        .info-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px; }
        .info-item { background: rgba(255, 255, 255, 0.1); padding: 20px; border-radius: 12px; }
        .typing-indicator { display: none; padding: 15px; background: white; border-radius: 15px; margin-left: auto; margin-right: 20%; max-width: 80%; border: 2px solid #e9ecef; }
        .typing-dots { display: flex; gap: 5px; }
        .typing-dots span { width: 8px; height: 8px; background: #667eea; border-radius: 50%; animation: typing 1.4s infinite ease-in-out; }
        .typing-dots span:nth-child(1) { animation-delay: -0.32s; }
        .typing-dots span:nth-child(2) { animation-delay: -0.16s; }
        @keyframes typing { 0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; } 40% { transform: scale(1); opacity: 1; } }
        .timestamp { font-size: 0.8rem; opacity: 0.7; margin-top: 8px; text-align: left; }
        @media (max-width: 768px) { .main-content { grid-template-columns: 1fr; } .message { max-width: 90%; } }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ§  Ù†Ø·Ù‚ Ù…ØµØ·Ù„Ø­</h1>
            <div class="subtitle">Ø³ÛŒØ³ØªÙ… Ø¯Ø§Ù†Ø´ Ù¾ÛŒØ´Ø±ÙØªÙ‡ - Ù†Ø³Ø®Ù‡ Û·.Û°.Û²</div>
            <div class="status-badge">âœ… Ø³ÛŒØ³ØªÙ… ÙØ¹Ø§Ù„ - Ù¾Ø§Ø³Ø®â€ŒØ¯Ù‡ÛŒ ÙÙˆØ±ÛŒ</div>
        </div>
        
        <div class="main-content">
            <div class="quick-actions">
                <h3>ğŸ¯ Ø§Ù‚Ø¯Ø§Ù…Ø§Øª Ø³Ø±ÛŒØ¹</h3>
                <div class="action-buttons">
                    <button class="action-btn" onclick="askQuestion('Ø±Ø§Ù…ÛŒÙ† Ø§Ø¬Ù„Ø§Ù„ Ú©ÛŒØ³ØªØŸ')">
                        <span>ğŸ‘¤ Ù…Ø¹Ø±ÙÛŒ Ø±Ø§Ù…ÛŒÙ† Ø§Ø¬Ù„Ø§Ù„</span>
                    </button>
                    <button class="action-btn" onclick="askQuestion('Ø¯Ø³ØªØ§ÙˆØ±Ø¯Ù‡Ø§ÛŒ Ø±Ø§Ù…ÛŒÙ† Ø§Ø¬Ù„Ø§Ù„ Ú†ÛŒØ³ØªØŸ')">
                        <span>ğŸ† Ø¯Ø³ØªØ§ÙˆØ±Ø¯Ù‡Ø§ Ùˆ Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§</span>
                    </button>
                    <button class="action-btn" onclick="askQuestion('ØªØ®ØµØµâ€ŒÙ‡Ø§ÛŒ Ø±Ø§Ù…ÛŒÙ† Ø§Ø¬Ù„Ø§Ù„')">
                        <span>ğŸ¯ Ù…Ù‡Ø§Ø±Øªâ€ŒÙ‡Ø§ Ùˆ ØªØ®ØµØµâ€ŒÙ‡Ø§</span>
                    </button>
                    <button class="action-btn" onclick="askQuestion('Ù…Ù‚Ø§Ù„Ù‡â€ŒØ§ÛŒ Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ø¨Ù†ÙˆÛŒØ³')">
                        <span>ğŸ“ ØªÙˆÙ„ÛŒØ¯ Ù…Ù‚Ø§Ù„Ù‡ ØªØ®ØµØµÛŒ</span>
                    </button>
                </div>
                
                <div style="margin-top: 30px; padding: 20px; background: white; border-radius: 12px;">
                    <h4 style="color: #2c3e50; margin-bottom: 15px;">ğŸ“Š ÙˆØ¶Ø¹ÛŒØª Ø³ÛŒØ³ØªÙ…</h4>
                    <div id="systemStatus">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...</div>
                </div>
            </div>
            
            <div class="chat-container">
                <div class="chat-messages" id="chatMessages">
                    <div class="message ai-message">
                        <strong>ğŸš€ Ø¨Ù‡ Ø³ÛŒØ³ØªÙ… Ù†Ø·Ù‚ Ù…ØµØ·Ù„Ø­ Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯!</strong><br><br>
                        Ø³ÛŒØ³ØªÙ… Ø§Ú©Ù†ÙˆÙ† Ú©Ø§Ù…Ù„Ø§Ù‹ ÙØ¹Ø§Ù„ Ùˆ Ù¾Ø§Ø³Ø®Ú¯Ùˆ Ø§Ø³Øª.<br><br>
                        ğŸ’¡ <strong>Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ù… Ø¯Ø± Ù…ÙˆØ±Ø¯:</strong><br>
                        â€¢ Ù…Ø¹Ø±ÙÛŒ Ø±Ø§Ù…ÛŒÙ† Ø§Ø¬Ù„Ø§Ù„<br>
                        â€¢ Ø¯Ø³ØªØ§ÙˆØ±Ø¯Ù‡Ø§ Ùˆ Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§<br>  
                        â€¢ Ù…Ù‡Ø§Ø±Øªâ€ŒÙ‡Ø§ Ùˆ ØªØ®ØµØµâ€ŒÙ‡Ø§<br>
                        â€¢ ØªÙˆÙ„ÛŒØ¯ Ù…Ø­ØªÙˆØ§ÛŒ ØªØ®ØµØµÛŒ<br><br>
                        Ú©Ù…Ú© Ú©Ù†Ù….
                        <div class="timestamp" id="welcomeTime"></div>
                    </div>
                </div>
                
                <div class="typing-indicator" id="typingIndicator">
                    <div class="typing-dots">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                </div>
                
                <div class="input-container">
                    <input type="text" id="questionInput" placeholder="Ø³ÙˆØ§Ù„ Ø®ÙˆØ¯ Ø±Ø§ Ø§ÛŒÙ†Ø¬Ø§ ØªØ§ÛŒÙ¾ Ú©Ù†ÛŒØ¯..." 
                           onkeypress="handleKeyPress(event)">
                    <button onclick="sendQuestion()">â†µ Ø§Ø±Ø³Ø§Ù„ Ø³ÙˆØ§Ù„</button>
                </div>
            </div>
        </div>
        
        <div class="system-info">
            <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap;">
                <div><strong>Ù†Ø·Ù‚ Ù…ØµØ·Ù„Ø­ v7.0.2</strong> | Ø³ÛŒØ³ØªÙ… Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ù¾Ø§ÛŒØ¯Ø§Ø±</div>
                <div id="connectionStatus">ğŸŸ¢ Ø¢Ù†Ù„Ø§ÛŒÙ†</div>
            </div>
        </div>
    </div>

    <script>
        document.getElementById('welcomeTime').textContent = new Date().toLocaleTimeString('fa-IR');
        
        fetch('/api/status')
            .then(response => response.json())
            .then(data => {
                document.getElementById('systemStatus').innerHTML = 
                    `<div>âœ… ${data.system}</div>
                     <div>ğŸŸ¢ ÙˆØ¶Ø¹ÛŒØª: ${data.status}</div>
                     <div>ğŸ”§ Ù†Ø³Ø®Ù‡: ${data.version}</div>`;
            });
        
        function handleKeyPress(event) {
            if (event.key === 'Enter') sendQuestion();
        }
        
        function askQuestion(question) {
            document.getElementById('questionInput').value = question;
            sendQuestion();
        }
        
        function sendQuestion() {
            const question = document.getElementById('questionInput').value.trim();
            if (!question) return;
            
            document.getElementById('questionInput').value = '';
            
            const chatMessages = document.getElementById('chatMessages');
            const userMessageDiv = document.createElement('div');
            userMessageDiv.className = 'message user-message';
            userMessageDiv.innerHTML = question + 
                `<div class="timestamp">${new Date().toLocaleTimeString('fa-IR')}</div>`;
            chatMessages.appendChild(userMessageDiv);
            
            const typingIndicator = document.getElementById('typingIndicator');
            typingIndicator.style.display = 'block';
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            fetch(`/api/chat?q=${encodeURIComponent(question)}`)
                .then(response => response.json())
                .then(data => {
                    typingIndicator.style.display = 'none';
                    
                    const aiMessageDiv = document.createElement('div');
                    aiMessageDiv.className = 'message ai-message';
                    
                    let answer = data.answer;
                    answer = answer.replace(/\n/g, '<br>');
                    answer = answer.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                    
                    aiMessageDiv.innerHTML = answer + 
                        `<div class="timestamp">${new Date().toLocaleTimeString('fa-IR')}</div>`;
                    chatMessages.appendChild(aiMessageDiv);
                    
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                })
                .catch(error => {
                    typingIndicator.style.display = 'none';
                    const errorMessageDiv = document.createElement('div');
                    errorMessageDiv.className = 'message ai-message';
                    errorMessageDiv.innerHTML = 'âš ï¸ Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ø³Ø±ÙˆØ±. Ù„Ø·ÙØ§Ù‹ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯.';
                    chatMessages.appendChild(errorMessageDiv);
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                });
        }
        
        window.onload = function() {
            document.getElementById('questionInput').focus();
        };
    </script>
</body>
</html>
