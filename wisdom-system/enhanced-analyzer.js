// Ø³ÛŒØ³ØªÙ… ØªØ­Ù„ÛŒÙ„ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ø¨Ø±Ø§ÛŒ Ø³ÙˆØ§Ù„Ø§Øª Ù¾ÛŒÚ†ÛŒØ¯Ù‡
class EnhancedAnalyzer {
    static analyzeQuestion(question) {
        const concepts = {
            // Ù…ÙˆØ¶ÙˆØ¹Ø§Øª ØªÚ©Ù†ÙˆÙ„ÙˆÚ˜ÛŒ Ùˆ ØªØ¹Ø§Ø¯Ù„
            'ØªÚ©Ù†ÙˆÙ„ÙˆÚ˜ÛŒ|technology|innovation|Ø¯ÛŒØ¬ÛŒØªØ§Ù„': {
                concept: 'ØªØ¹Ø§Ø¯Ù„ ØªÚ©Ù†ÙˆÙ„ÙˆÚ˜ÛŒ Ùˆ Ø§Ù†Ø³Ø§Ù†ÛŒØª',
                response: "Ø¯Ø± Ø¯Ù†ÛŒØ§ÛŒ Ù¾Ø±Ø³Ø±Ø¹Øª ØªÚ©Ù†ÙˆÙ„ÙˆÚ˜ÛŒØŒ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ Ù…ÛŒâ€ŒÚ©Ù†Ù…:\n\nÛ±. **Ø¢Ù…ÙˆØ²Ø´ Ù…Ø³ØªÙ…Ø±**: Ù‡ÙØªÙ‡â€ŒØ§ÛŒ Ú†Ù†Ø¯ Ø³Ø§Ø¹Øª Ø¨Ù‡ ÛŒØ§Ø¯Ú¯ÛŒØ±ÛŒ Ù…Ù‡Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯ Ø§Ø®ØªØµØ§Øµ Ø¯Ù‡ÛŒØ¯\nÛ². **Ù…Ø±Ø²Ø¨Ù†Ø¯ÛŒ Ø¯ÛŒØ¬ÛŒØªØ§Ù„**: Ø²Ù…Ø§Ù†â€ŒÙ‡Ø§ÛŒ Ø¨Ø¯ÙˆÙ† Ø¯Ø³ØªÚ¯Ø§Ù‡ ØªØ¹ÛŒÛŒÙ† Ú©Ù†ÛŒØ¯\nÛ³. **ØªÙ…Ø±Ú©Ø² Ø¨Ø± Ø§Ø±Ø²Ø´â€ŒÙ‡Ø§**: Ø§Ø² ØªÚ©Ù†ÙˆÙ„ÙˆÚ˜ÛŒ Ø¨Ø±Ø§ÛŒ ØªÙ‚ÙˆÛŒØª Ø§Ø±ØªØ¨Ø§Ø·Ø§Øª Ø§Ù†Ø³Ø§Ù†ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯\nÛ´. **ØªÙÚ©Ø± Ø§Ù†ØªÙ‚Ø§Ø¯ÛŒ**: Ù‡Ù…ÛŒØ´Ù‡ ØªØ£Ø«ÛŒØ± ØªÚ©Ù†ÙˆÙ„ÙˆÚ˜ÛŒ Ø¨Ø± Ø²Ù†Ø¯Ú¯ÛŒâ€ŒØªØ§Ù† Ø±Ø§ Ø§Ø±Ø²ÛŒØ§Ø¨ÛŒ Ú©Ù†ÛŒØ¯",
                depth: 4
            },
            
            // Ù…ÙˆØ¶ÙˆØ¹Ø§Øª Ø±Ù‡Ø¨Ø±ÛŒ
            'Ø±Ù‡Ø¨Ø±|leader|Ù…Ø¯ÛŒØ±ÛŒØª|leadership|Ø§Ù‚ØªØ¯Ø§Ø±|Ù‡Ù…Ø¯Ù„ÛŒ': {
                concept: 'ØªØ¹Ø§Ø¯Ù„ Ø¯Ø± Ø±Ù‡Ø¨Ø±ÛŒ',
                response: "Ø¨Ø±Ø§ÛŒ Ø§ÛŒØ¬Ø§Ø¯ ØªØ¹Ø§Ø¯Ù„ Ø¨ÛŒÙ† Ø§Ù‚ØªØ¯Ø§Ø± Ùˆ Ù‡Ù…Ø¯Ù„ÛŒ:\n\n**Ø§Ù‚ØªØ¯Ø§Ø± Ù‡ÙˆØ´Ù…Ù†Ø¯**:\nâ€¢ Ù‡Ø¯Ùâ€ŒÙ‡Ø§ÛŒ ÙˆØ§Ø¶Ø­ ØªØ¹ÛŒÛŒÙ† Ú©Ù†ÛŒØ¯\nâ€¢ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯Ù‡Ø§ÛŒ Ø±ÙˆØ´Ù† Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒØ¯\nâ€¢ Ø¯Ø± ØªØµÙ…ÛŒÙ…â€ŒÚ¯ÛŒØ±ÛŒ Ù‚Ø§Ø·Ø¹ Ø¨Ø§Ø´ÛŒØ¯\n\n**Ù‡Ù…Ø¯Ù„ÛŒ Ø§Ø«Ø±Ø¨Ø®Ø´**:\nâ€¢ ÙØ¹Ø§Ù„Ø§Ù†Ù‡ Ú¯ÙˆØ´ Ø¯Ù‡ÛŒØ¯\nâ€¢ Ù†ÛŒØ§Ø²Ù‡Ø§ÛŒ ØªÛŒÙ… Ø±Ø§ Ø¯Ø±Ú© Ú©Ù†ÛŒØ¯\nâ€¢ Ø§Ù†Ø¹Ø·Ø§Ùâ€ŒÙ¾Ø°ÛŒØ± Ø¨Ø§Ø´ÛŒØ¯\n\nØ±Ù‡Ø¨Ø±Ø§Ù† Ø¨Ø²Ø±Ú¯ Ø¯Ø± Ù„Ø­Ø¸Ø§Øª Ø³Ø®Øª Ù‚Ø§Ø·Ø¹ Ùˆ Ø¯Ø± Ø§Ø±ØªØ¨Ø§Ø·Ø§Øª Ø¯Ù„Ø³ÙˆØ² Ù‡Ø³ØªÙ†Ø¯.",
                depth: 5
            },
            
            // Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ø³ØªØ±Ø³
            'Ø§Ø³ØªØ±Ø³|Ø§Ø¶Ø·Ø±Ø§Ø¨|Ø¢Ø±Ø§Ù…Ø´|Ø°Ù‡Ù†|stress|anxiety': {
                concept: 'Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ø³ØªØ±Ø³ Ù¾ÛŒØ´Ø±ÙØªÙ‡',
                response: "Ø±Ø§Ù‡Ú©Ø§Ø±Ù‡Ø§ÛŒ Ø­ÙØ¸ Ø¢Ø±Ø§Ù…Ø´ Ø°Ù‡Ù†ÛŒ:\n\nðŸŒ¿ **ØªÙ…Ø±ÛŒÙ†Ø§Øª ÙÙˆØ±ÛŒ**:\nâ€¢ ØªÙ†ÙØ³ Û´-Û·-Û¸ (Û´ Ø«Ø§Ù†ÛŒÙ‡ Ø¯Ù…ØŒ Û· Ø­Ø¨Ø³ØŒ Û¸ Ø¨Ø§Ø²Ø¯Ù…)\nâ€¢ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ±ÙˆÛŒ Ûµ Ø¯Ù‚ÛŒÙ‚Ù‡â€ŒØ§ÛŒ\nâ€¢ Ù†ÙˆØ´ÛŒØ¯Ù† Ø¢Ø¨ Ø¢Ø±Ø§Ù…\n\nðŸŽ¯ **Ø±Ø§Ù‡Ø¨Ø±Ø¯Ù‡Ø§ÛŒ Ø¨Ù„Ù†Ø¯Ù…Ø¯Øª**:\nâ€¢ Ù…Ø¯ÛŒØªÛŒØ´Ù† Ø±ÙˆØ²Ø§Ù†Ù‡ Û±Û° Ø¯Ù‚ÛŒÙ‚Ù‡\nâ€¢ ÙˆØ±Ø²Ø´ Ù…Ù†Ø¸Ù…\nâ€¢ Ù…Ø¯ÛŒØ±ÛŒØª Ø²Ù…Ø§Ù† Ø¨Ø§ ØªÚ©Ù†ÛŒÚ© Ù¾ÙˆÙ…ÙˆØ¯ÙˆØ±Ùˆ\nâ€¢ Ù…Ø±Ø²Ø¨Ù†Ø¯ÛŒ Ø³Ø§Ù„Ù…\n\nðŸ’¡ **ØªØºÛŒÛŒØ± Ù†Ú¯Ø±Ø´**:\nâ€¢ Ù¾Ø°ÛŒØ±Ø´ Ø¹Ø¯Ù… Ù‚Ø·Ø¹ÛŒØª\nâ€¢ ØªÙ…Ø±Ú©Ø² Ø¨Ø± Ø¢Ù†Ú†Ù‡ Ù‚Ø§Ø¨Ù„ Ú©Ù†ØªØ±Ù„ Ø§Ø³Øª\nâ€¢ Ù‚Ø¯Ø±Ø¯Ø§Ù†ÛŒ Ø±ÙˆØ²Ø§Ù†Ù‡",
                depth: 4
            },
            
            // Ù…ÛŒØ±Ø§Ø« Ùˆ Ø§Ø«Ø±Ú¯Ø°Ø§Ø±ÛŒ
            'legacy|Ù…ÛŒØ±Ø§Ø«|Ø§Ø«Ø±|Ø¨Ø§Ù‚ÛŒ|meaningful|Ù…Ø¹Ù†Ø§Ø¯Ø§Ø±': {
                concept: 'Ø³Ø§Ø®ØªÙ† Ù…ÛŒØ±Ø§Ø« Ù…Ø¹Ù†Ø§Ø¯Ø§Ø±',
                response: "Ø¨Ø±Ø§ÛŒ Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒØ±Ø§Ø« Ù…Ø¹Ù†Ø§Ø¯Ø§Ø±:\n\nÛ±. **Ø®Ø¯Ù…Øª Ø¨Ù‡ Ø¯ÛŒÚ¯Ø±Ø§Ù†**: Ø¯Ø§Ù†Ø´ Ùˆ ØªØ¬Ø±Ø¨Ù‡â€ŒØªØ§Ù† Ø±Ø§ Ø¨Ù‡ Ø§Ø´ØªØ±Ø§Ú© Ø¨Ú¯Ø°Ø§Ø±ÛŒØ¯\nÛ². **Ø®Ù„Ø§Ù‚ÛŒØª Ùˆ Ù†ÙˆØ¢ÙˆØ±ÛŒ**: Ú†ÛŒØ²ÛŒ Ø®Ù„Ù‚ Ú©Ù†ÛŒØ¯ Ú©Ù‡ Ù¾Ø³ Ø§Ø² Ø´Ù…Ø§ Ø¨Ø§Ù‚ÛŒ Ø¨Ù…Ø§Ù†Ø¯\nÛ³. **Ù¾Ø±ÙˆØ±Ø´ Ù†Ø³Ù„ Ø¨Ø¹Ø¯**: Ù…Ø±Ø¨ÛŒâ€ŒÚ¯Ø±ÛŒ Ùˆ Ø¢Ù…ÙˆØ²Ø´ Ø¯Ù‡ÛŒØ¯\nÛ´. **Ø§Ø±Ø²Ø´â€ŒÙ‡Ø§ÛŒ Ø§ØµÛŒÙ„**: Ø¨Ø± Ø§Ø³Ø§Ø³ Ø§ØµÙˆÙ„ Ø§Ø®Ù„Ø§Ù‚ÛŒ Ø¹Ù…Ù„ Ú©Ù†ÛŒØ¯\nÛµ. **ØªØ£Ø«ÛŒØ± Ù¾Ø§ÛŒØ¯Ø§Ø±**: Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§ÛŒÛŒ Ø´Ø±ÙˆØ¹ Ú©Ù†ÛŒØ¯ Ú©Ù‡ Ø§Ø¯Ø§Ù…Ù‡ Ø¯Ø§Ø± Ø¨Ø§Ø´Ù†Ø¯\n\nÙ…ÛŒØ±Ø§Ø« ÙˆØ§Ù‚Ø¹ÛŒ Ø¯Ø± Ù‚Ù„Ø¨â€ŒÙ‡Ø§ Ùˆ Ø°Ù‡Ù†â€ŒÙ‡Ø§ Ø³Ø§Ø®ØªÙ‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯ØŒ Ù†Ù‡ ÙÙ‚Ø· Ø¯Ø± Ù…ÙˆØ²Ù‡â€ŒÙ‡Ø§.",
                depth: 5
            }
        };

        // ØªØ­Ù„ÛŒÙ„ Ø³ÙˆØ§Ù„ Ø¨Ø±Ø§ÛŒ ÛŒØ§ÙØªÙ† Ú©Ù„ÛŒØ¯ÙˆØ§Ú˜Ù‡â€ŒÙ‡Ø§
        const questionLower = question.toLowerCase();
        let bestMatch = null;
        let highestScore = 0;

        for (const [pattern, conceptData] of Object.entries(concepts)) {
            const patterns = pattern.split('|');
            let score = 0;
            
            for (const p of patterns) {
                if (questionLower.includes(p)) {
                    score += p.length * 2; // ÙˆØ²Ù† Ø¨Ø± Ø§Ø³Ø§Ø³ Ø·ÙˆÙ„ Ú©Ù„ÛŒØ¯ÙˆØ§Ú˜Ù‡
                }
            }
            
            if (score > highestScore) {
                highestScore = score;
                bestMatch = conceptData;
            }
        }

        return bestMatch || {
            concept: 'Ø®Ø±Ø¯ Ø¹Ù…Ù„ÛŒ',
            response: "Ø¨Ø± Ø§Ø³Ø§Ø³ Ø®Ø±Ø¯ Ú©Ù‡Ù†ØŒ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ Ù…ÛŒâ€ŒÚ©Ù†Ù…:\n\nâ€¢ ØªØ¹Ø§Ø¯Ù„ Ø±Ø§ Ø¯Ø± Ù‡Ù…Ù‡ Ø¬Ù†Ø¨Ù‡â€ŒÙ‡Ø§ÛŒ Ø²Ù†Ø¯Ú¯ÛŒ Ø¬Ø³ØªØ¬Ùˆ Ú©Ù†ÛŒØ¯\nâ€¢ Ø¨Ù‡ Ù†Ø¯Ø§ÛŒ Ø¯Ø±ÙˆÙ† Ø®ÙˆØ¯ Ø§Ø¹ØªÙ…Ø§Ø¯ Ú©Ù†ÛŒØ¯\nâ€¢ Ø§Ø±Ø²Ø´â€ŒÙ‡Ø§ÛŒ Ø§ØµÛŒÙ„ Ø±Ø§ Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø®ÙˆØ¯ Ù‚Ø±Ø§Ø± Ø¯Ù‡ÛŒØ¯\nâ€¢ Ø¯Ø± Ø®Ø¯Ù…Øª Ø¨Ù‡ Ø¯ÛŒÚ¯Ø±Ø§Ù† Ù…Ø¹Ù†Ø§ÛŒ Ø¹Ù…ÛŒÙ‚ Ø¨ÛŒØ§Ø¨ÛŒØ¯\nâ€¢ Ù‡Ù…ÙˆØ§Ø±Ù‡ Ø¯Ø± Ø­Ø§Ù„ ÛŒØ§Ø¯Ú¯ÛŒØ±ÛŒ Ùˆ Ø±Ø´Ø¯ Ø¨Ø§Ø´ÛŒØ¯",
            depth: 3
        };
    }

    static detectLanguage(question) {
        const persianChars = /[\u0600-\u06FF]/;
        const englishChars = /[a-zA-Z]/;
        
        const hasPersian = persianChars.test(question);
        const hasEnglish = englishChars.test(question);
        
        if (hasPersian && hasEnglish) return 'mixed';
        if (hasPersian) return 'persian';
        if (hasEnglish) return 'english';
        return 'unknown';
    }
}

export default EnhancedAnalyzer;
